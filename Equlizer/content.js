!function(e){var t={};function o(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t){var o={};const n=async e=>{o.audioContext=new AudioContext({latencyHint:"playback"}),o.audioSource=o.audioContext.createMediaStreamSource(e),o.audioGain=o.audioContext.createGain();let t=new Tuna(o.audioContext);const{isChorus:n,isConvolver:r,isMono:u,isPitch:i,volume:c,eq:s,convolver:d,chorus:l,compressor:m}=await class{static getItem(e){return new Promise(t=>chrome.storage.local.get(e,e=>t(e)))}static getCurrentTab(){return new Promise(async e=>{let[t]=await chrome.tabs.query({active:!0,lastFocusedWindow:!0});e(t)})}}.getItem({isChorus:!1,isConvolver:!0,compressor:{threshold:-20,attack:0,release:250,makeupGain:1,ratio:4,knee:5,bypass:!1,automakeup:!1},convolver:{highCut:22050,lowCut:20,dryLevel:1,wetLevel:1,level:1,bypass:!1},chorus:{rate:0,depth:.7,feedback:.4,delay:.0045},isMono:!1,isPitch:!1,volume:1,eq:[0,0,0,0,0,0,0,0,0,0]});return n&&(o.chorus=new t.Chorus({bypass:0,rate:l.rate,depth:l.depth,feedback:l.depth,delay:l.delay})),r&&(o.convolver=new t.Convolver({bypass:0,highCut:d.highCut,lowCut:d.lowCut,dryLevel:d.dryLevel,wetLevel:d.wetLevel,level:d.level})),i&&(o.pitch=new Jungle(o.audioContext)),o.compressor=new t.Compressor({bypass:0,threshold:m.threshold,attack:m.attack,release:m.release,makeupGain:m.makeupGain,ratio:m.ratio,knee:m.knee}),o.panSplitter=o.audioContext.createChannelSplitter(2),o.leftGain=o.audioContext.createGain(),o.rightGain=o.audioContext.createGain(),o.panMerger=o.audioContext.createChannelMerger(2),o.monoSplitter=o.audioContext.createChannelSplitter(2),o.monoGain=o.audioContext.createGain(),o.monoMerger=o.audioContext.createChannelMerger(2),o.twenty=o.audioContext.createBiquadFilter(),o.fifty=o.audioContext.createBiquadFilter(),o.oneHundred=o.audioContext.createBiquadFilter(),o.twoHundred=o.audioContext.createBiquadFilter(),o.fiveHundred=o.audioContext.createBiquadFilter(),o.oneThousand=o.audioContext.createBiquadFilter(),o.twoThousand=o.audioContext.createBiquadFilter(),o.fiveThousand=o.audioContext.createBiquadFilter(),o.tenThousand=o.audioContext.createBiquadFilter(),o.twentyThousand=o.audioContext.createBiquadFilter(),o.twenty.type="lowshelf",o.twenty.frequency.setValueAtTime(32,o.audioContext.currentTime),o.twenty.gain.setValueAtTime(Number(s[0]),o.audioContext.currentTime),o.fifty.type="peaking",o.fifty.frequency.setValueAtTime(64,o.audioContext.currentTime),o.fifty.Q.setValueAtTime(5,o.audioContext.currentTime),o.fifty.gain.setValueAtTime(Number(s[1]),o.audioContext.currentTime),o.oneHundred.type="peaking",o.oneHundred.frequency.setValueAtTime(125,o.audioContext.currentTime),o.oneHundred.Q.setValueAtTime(5,o.audioContext.currentTime),o.oneHundred.gain.setValueAtTime(Number(s[2]),o.audioContext.currentTime),o.twoHundred.type="peaking",o.twoHundred.frequency.setValueAtTime(250,o.audioContext.currentTime),o.twoHundred.Q.setValueAtTime(5,o.audioContext.currentTime),o.twoHundred.gain.setValueAtTime(Number(s[3]),o.audioContext.currentTime),o.fiveHundred.type="peaking",o.fiveHundred.frequency.setValueAtTime(500,o.audioContext.currentTime),o.fiveHundred.Q.setValueAtTime(5,o.audioContext.currentTime),o.fiveHundred.gain.setValueAtTime(Number(s[4]),o.audioContext.currentTime),o.oneThousand.type="peaking",o.oneThousand.frequency.setValueAtTime(1e3,o.audioContext.currentTime),o.oneThousand.Q.setValueAtTime(5,o.audioContext.currentTime),o.oneThousand.gain.setValueAtTime(Number(s[5]),o.audioContext.currentTime),o.twoThousand.type="peaking",o.twoThousand.frequency.setValueAtTime(2e3,o.audioContext.currentTime),o.twoThousand.Q.setValueAtTime(5,o.audioContext.currentTime),o.twoThousand.gain.setValueAtTime(Number(s[6]),o.audioContext.currentTime),o.fiveThousand.type="peaking",o.fiveThousand.frequency.setValueAtTime(4e3,o.audioContext.currentTime),o.fiveThousand.Q.setValueAtTime(5,o.audioContext.currentTime),o.fiveThousand.gain.setValueAtTime(Number(s[7]),o.audioContext.currentTime),o.tenThousand.type="peaking",o.tenThousand.frequency.setValueAtTime(8e3,o.audioContext.currentTime),o.tenThousand.Q.setValueAtTime(5,o.audioContext.currentTime),o.tenThousand.gain.setValueAtTime(Number(s[8]),o.audioContext.currentTime),o.twentyThousand.type="highshelf",o.twentyThousand.frequency.setValueAtTime(16e3,o.audioContext.currentTime),o.twentyThousand.gain.setValueAtTime(Number(s[9]),o.audioContext.currentTime),o.audioGain.gain.setValueAtTime(c,o.audioContext.currentTime),o.monoGain.gain.setValueAtTime(.6,o.audioContext.currentTime),i&&(o.pitch.value=0,o.pitch.setPitchOffset(0)),o.audioSource.connect(o.panSplitter),o.panSplitter.connect(o.leftGain,0),o.panSplitter.connect(o.rightGain,1),o.leftGain.connect(o.panMerger,0,0),o.rightGain.connect(o.panMerger,0,1),a(!!u),i&&n&&r?(o.monoMerger.connect(o.pitch),o.pitch.output.connect(o.chorus),o.chorus.connect(o.convolver),o.convolver.connect(o.twenty)):!i&&n&&r?(o.monoMerger.connect(o.chorus),o.chorus.connect(o.convolver),o.convolver.connect(o.twenty)):i&&!n&&r?(o.monoMerger.connect(o.pitch),o.pitch.output.connect(o.convolver),o.convolver.connect(o.twenty)):i&&n&&!r?(o.monoMerger.connect(o.pitch),o.pitch.output.connect(o.chorus),o.chorus.connect(o.twenty)):!i||n||r?i||n||!r?i||r||!n?i||n||r||o.monoMerger.connect(o.twenty):(o.monoMerger.connect(o.chorus),o.chorus.connect(o.twenty)):(o.monoMerger.connect(o.convolver),o.convolver.connect(o.twenty)):(o.monoMerger.connect(o.pitch),o.pitch.output.connect(o.twenty)),o.twenty.connect(o.fifty),o.fifty.connect(o.oneHundred),o.oneHundred.connect(o.twoHundred),o.twoHundred.connect(o.fiveHundred),o.fiveHundred.connect(o.oneThousand),o.oneThousand.connect(o.twoThousand),o.twoThousand.connect(o.fiveThousand),o.fiveThousand.connect(o.tenThousand),o.tenThousand.connect(o.twentyThousand),o.twentyThousand.connect(o.audioGain),o.audioGain.connect(o.audioContext.destination),o};function a(e){1==o.panMerger.context.__connectified__&&o.panMerger.disconnect(),1==o.monoSplitter.context.__connectified__&&o.monoSplitter.disconnect(),1==o.monoGain.context.__connectified__&&o.monoGain.disconnect(),!0===e?(o.panMerger.connect(o.monoGain),o.monoGain.connect(o.monoSplitter),o.monoSplitter.connect(o.monoMerger,0,1),o.monoSplitter.connect(o.monoMerger,0,0),o.monoSplitter.connect(o.monoMerger,1,0)):(o.panMerger.connect(o.monoSplitter),o.monoSplitter.connect(o.monoMerger,0,0)),o.monoSplitter.connect(o.monoMerger,1,1)}function r(){return new Promise(async(e,t)=>{const o=await new Promise(e=>{chrome.tabCapture.capture({audio:!0,video:!1},t=>{e(t)})});o?(await n(o),e(o)):window.close()})}chrome.runtime.onMessage.addListener((e,t,n)=>{const{type:a}=e;switch(a.toLowerCase()){case"start_record":r().then(()=>{o.id=e.data.currentTabId,n({status:!0})});break;case"change_volume":o.audioGain.gain.value=e.value,n({status:!0,...e});break;case"change_equalizer":var{value:u}=e;o.twenty.gain.setValueAtTime(Number(u[0]),o.audioContext.currentTime),o.fifty.gain.setValueAtTime(Number(u[1]),o.audioContext.currentTime),o.oneHundred.gain.setValueAtTime(Number(u[2]),o.audioContext.currentTime),o.twoHundred.gain.setValueAtTime(Number(u[3]),o.audioContext.currentTime),o.fiveHundred.gain.setValueAtTime(Number(u[4]),o.audioContext.currentTime),o.oneThousand.gain.setValueAtTime(Number(u[5]),o.audioContext.currentTime),o.twoThousand.gain.setValueAtTime(Number(u[6]),o.audioContext.currentTime),o.fiveThousand.gain.setValueAtTime(Number(u[7]),o.audioContext.currentTime),o.tenThousand.gain.setValueAtTime(Number(u[8]),o.audioContext.currentTime),o.twentyThousand.gain.setValueAtTime(Number(u[9]),o.audioContext.currentTime),n({status:!0,...e});break;case"closeaudio":case"closeAudio":o.audioSource?(window.close(),o.audioContext.close(),o={},n({status:!0,...e})):n({status:!0,...e});break;case"change_compressor":{const{threshold:t,release:a,makeupGain:r,attack:u,ratio:i,knee:c}=e.value;o.compressor.automate("threshold",parseFloat(t)),o.compressor.automate("release",parseFloat(a)),o.compressor.automate("makeupGain",parseFloat(r)),o.compressor.automate("attack",parseFloat(u)),o.compressor.automate("ratio",parseFloat(i)),o.compressor.automate("knee",parseFloat(c)),n(o.compressor);break}case"change_pitch":{let t=e;o.pitch?(o.pitch.setPitchOffset(t.value.value),o.pitch.value=t.value.value,n(t)):(o={},chrome.storage.local.set({isPitch:!0},()=>{r().then(()=>{o.pitch.setPitchOffset(t.value.value),o.pitch.value=t.value.value,n(t)})}));break}case"change_convolver":{const t=e;o.convolver?(o.convolver.automate("lowCut",parseFloat(t.value.lowCut)),o.convolver.automate("highCut",parseFloat(t.value.highCut)),o.convolver.automate("wetLevel",parseFloat(t.value.wetLevel)),o.convolver.automate("level",parseFloat(t.value.level)),o.convolver.automate("dryLevel",parseFloat(t.value.dryLevel)),n({status:!0,...e})):(o={},chrome.storage.local.set({isConvolver:!0},()=>{r().then(()=>{o.convolver.automate("lowCut",parseFloat(t.value.lowCut))})}));break}case"change_chorus":{const t=e;o.chorus?(o.chorus.rate=parseFloat(t.value.rate),o.chorus.depth=parseFloat(t.value.depth),o.chorus.feedback=parseFloat(t.value.feedback),o.chorus.delay=parseFloat(t.value.delay),o.chorusFixedDelay=t.value.delay,n({status:!0,...e})):(o={},chrome.storage.local.set({isChorus:!0},()=>{r().then(()=>{o.chorus.rate=parseFloat(t.value.rate),o.chorus.depth=parseFloat(t.value.depth),o.chorus.feedback=parseFloat(t.value.feedback),o.chorus.delay=parseFloat(t.value.delay),o.chorusFixedDelay=t.value.delay,n({status:!0,...e})})}));break}case"connect_compressor":o.twentyThousand.disconnect(o.audioGain),o.twentyThousand.connect(o.compressor),o.compressor.connect(o.audioGain),o.audioGain.connect(o.audioContext.destination),n({status:!1,...e});break;case"disconnect_compressor":o.compressor.disconnect(o.audioGain),o.twentyThousand.connect(o.audioGain),o.audioGain.connect(o.audioContext.destination),n({status:!1,...e});break;default:n({status:!1,...e})}});const u=e=>new Promise(t=>{chrome.storage.local.get([e],o=>{t(o[e])})});chrome.tabCapture.onStatusChanged.addListener((function(e){"active"==e.status&&e.tabId&&chrome.storage.local.set({fullScreen:!0},()=>{chrome.windows.getCurrent((async function(t){const o=t.id;if(!1!==await u("fullScreen"))if(1==e.fullscreen)chrome.storage.local.set({windowState:t.state}),chrome.windows.update(o,{state:"fullscreen"},null);else{const e=await u("windowState");chrome.windows.update(o,{state:e},null)}else chrome.windows.update(o,{state:t.state},null)}))})}))}]);